!function(t){function e(t){t+="";var e=t[0].toUpperCase();return e+t.substr(1)}function n(e,i){var o,r=this,a=t.extend(!0,{},n.defaultSettings,i);for(index=0;index<t(e).length;index++)if(void 0!==(o=t(e).data(s))){if(!a.autoReassign)return!1;o.remove(t(e))}this.$elements=t(e),this.settings=a,this._init(),this.$elements.each(function(){t(this).data(s,r)})}var s="__apifs__",i="apifs-",o="apifs",r="apifs";String.prototype.ucfirst||(String.prototype.ucfirst=function(){return e(this)}),jQuery.fn.tagName=function(){return this.prop("tagName").toLowerCase()},n.prototype={_init:function(){this.currentIndex=-1,this.opened=!1,this.usePseudeoFullscreenFallback=!1,this._addContainer(),this._obtainAndAppendImages(),this._addButtons(),this._bind(),this.settings.autoOpen&&this.open()},_addContainer:function(){this.$container=t(n.template).appendTo(t("body")),this.$fullscreenElement=this.$container.find("."+i+"fullscreen-element").attr("tabIndex",-1),this.$wrapper=this.$container.find("."+i+"wrapper"),this.$images=this.$container.find("."+i+"images")},_removeContainer:function(){this.$container.remove()},_obtainAndAppendImages:function(){var e,n,s,i=this;this.$elements.each(function(o){void 0!==(e=i._obtainImageUrl(this))&&void 0!==(n=i._addImage(e))&&(void 0!==(s=t(this).data("background-color"))&&n.css("background-color",s),(i.settings.lazyLoad===!1||"instant"==i.settings.lazyLoad)&&i._loadImages(n))})},_obtainImageUrl:function(e){switch(t(e).tagName()){case"img":return t(e).attr("src");case"a":return t(e).attr("href")}},_addImage:function(e,n){var s="string"==typeof e?e:this._obtainImageUrl(e);if(s){var i=t("<li></li>").data({imageUrl:s,loaded:!1}),o=this._getItemCount();return o>0&&"number"==typeof n?(n=Math.min(Math.max(0,parseInt(n)),o-1),this._getItem(n).before(i)):this.$images.append(i),i}},_loadImages:function(e){var n=this;e.each(function(){if(t(this).data("loaded")===!1){var e=t.extend({imageUrl:t(this).data("imageUrl"),onSwipeRight:function(){n.settings.enableSwipe&&n.previous()},onSwipeLeft:function(){n.settings.enableSwipe&&n.next()},onLoaded:function(){n._trigger("imageLoaded")}},n.settings.imageZoom);t(this).data("loaded",!0).apImageZoom(e)}})},_addButtons:function(){this._addButtonContainers();var e=["previous","next","close","download"];for(index in e){var n,s=e[index];if("object"==typeof this.settings.buttons&&void 0!=(n=this.settings.buttons[s])){var o=n.position.split(",").map(function(t){return t.trim().toLowerCase()});if(["left","right"].indexOf(o[0])>-1&&["top","center","bottom"].indexOf(o[1])>-1){var r=t("<a></a>").html(s.ucfirst()).attr("href","#"+s).addClass(i+"button").addClass(i+s+"-button");"string"==typeof n.text&&r.attr("alt",n.text).attr("title",n.text);var a="."+i+"buttons-"+o[0]+"-"+o[1];this.$wrapper.find(a).append(r),this["$"+s+"Button"]=r,r.data("clickMethodName",s),n.visible===!1&&r.hide();var l="string"==typeof n.theme?n.theme:this.settings.defaultTheme;r.addClass(i+"button-theme-"+l)}}}this._updateButtons()},_addButtonContainers:function(){var e=["left","right"],n=["top","center","bottom"];for(hIndex in e)for(vIndex in n)t("<div></div>").addClass(i+"buttons").addClass(i+"buttons-"+e[hIndex]+"-"+n[vIndex]).appendTo(this.$wrapper)},_updateButtons:function(){var t=i+"button-disabled";0==this.currentIndex?this.$previousButton.addClass(t):this.$previousButton.hasClass(t)&&this.$previousButton.removeClass(t),this.currentIndex==this._getItemCount()-1?this.$nextButton.addClass(t):this.$nextButton.hasClass(t)&&this.$nextButton.removeClass(t)},_bind:function(){var e=this,n=["previous","next","close","download"];for(index in n){var s=this["$"+n[index]+"Button"];s.on("click."+o,function(){if(!t(this).hasClass(i+"button-disabled")){var n=e[t(this).data("clickMethodName")];"function"==typeof n&&n.apply(e)}return!1})}var r={9:"tab","9+s":"shiftTab",27:"escape",32:"space",33:"pageUp",34:"pageDown",35:"end",36:"pos1",37:"left",38:"up",39:"right",40:"down"};this.$fullscreenElement.on("keydown."+o,function(t){if(e.opened)if(8==t.keyCode)e.close();else if(t.keyCode>=48&&t.keyCode<=57&&e.settings.shortcuts.paging){var n=t.keyCode-48;"first"!=e.settings.shortcuts.zeroHandling&&(n--,"tenth"==e.settings.shortcuts.zeroHandling&&-1==n&&(n=9)),n>=0&&n<e._getItemCount()&&e._show(n,!0),t.preventDefault()}else{var s,i=t.keyCode+(t.shiftKey?"+s":"");if(i in e.settings.shortcuts)s=e.settings.shortcuts[i];else if(i in r){var o=r[i];s=e.settings.shortcuts[o]}s&&e._handleKeyAction(s,t)&&t.preventDefault()}}),screenfull.enabled&&document.addEventListener(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen?e._resetItems(e.currentIndex):e._onFullscreenClose()})},_handleKeyAction:function(t,e){if("function"==typeof t){var n=this._getCurrentItem();t.apply(n,e)}else switch(t){case"zoomIn":return this._getCurrentItem().apImageZoom("zoomIn"),!0;case"zoomOut":return this._getCurrentItem().apImageZoom("zoomOut"),!0;case"zoomToggle":return this._getCurrentItem().apImageZoom("zoomToggle"),!0;case"next":return this.next(),!0;case"previous":return this.previous(),!0;case"first":return this.first(),!0;case"last":return this.last(),!0;case"close":return this.close(),!0}return!1},_unbind:function(){var t=["previous","next","close","download"];for(index in t){var e=this["$"+t[index]+"Button"];e.off("click."+o)}this.$fullscreenElement.off("keydown."+o)},_show:function(t,e){var n=this;if(t=Math.min(Math.max(t,0),this._getItemCount()-1),this.currentIndex!=t){this.currentIndex=t;var s=this._getItem(t),i=function(){"visible"==n.settings.lazyLoad&&n._loadImages(s)};this.settings.resetOnScroll&&this._resetItems(s);var o=-1*t*100+"%";e===!0?this.$images.stop(!0,!1).animate({left:o},this.settings.slideDuration,i):(this.$images.css("left",o),i()),this.$fullscreenElement.focus(),this._updateButtons()}},_getItem:function(t){var e=this.$images.children(":eq("+t+")");return e},_getCurrentItem:function(){var t=this._getItem(this.currentIndex);return t},_getAllItems:function(){var t=this.$images.children();return t},_getItemCount:function(){var t=this.$images.children().length;return t},_resetItems:function(e){var n=this;void 0==e?e=this._getAllItems():"number"==typeof e&&(e=this._getItem(e)),e.each(function(){t(this).data("loaded")===!0&&(t(this).apImageZoom("reset"),n._trigger("reset",[t(this)]))})},_trigger:function(t,e,n){var s="on"+t.ucfirst(),i=this.settings[s];"function"==typeof i&&(n=n?n:this._getCurrentItem(),i.apply(n,e)),t=r+t.ucfirst(),this._getCurrentItem().trigger(t,e)},_triggerHandler:function(t,e,n){var s,i="on"+t.ucfirst(),o=this.settings[i],a=void 0;return n=n?n:this._getCurrentItem(),"function"==typeof o&&(a=o.apply(n,e)),t=r+t.ucfirst(),s=void 0!==(s=n.triggerHandler(t,e))?s:a},open:function(e){var n=this;this.opened||0==this._getItemCount()||(this.opened=!0,this.settings.lazyLoad!==!1&&"instant"!=this.settings.lazyLoad&&"visible"!==this.settings.lazyLoad&&this._loadImages(this._getAllItems()),this.settings.enableScreenfull&&"object"==typeof screenfull&&screenfull.enabled?(screenfull.request(this.$fullscreenElement[0]),t("html").removeClass(i+"pseudo-fullscreen").addClass(i+"screenfull"),this._validateVisibleFullscreen()):t("html").removeClass(i+"screenfull").addClass(i+"pseudo-fullscreen"),this.settings.resetOnOpen&&this._resetItems(),e||(e=this.currentIndex>-1?this.currentIndex:0),setTimeout(function(){n._show(e,!1)},100),this._trigger("open"))},_validateVisibleFullscreen:function(){var e=this;setTimeout(function(){e.$fullscreenElement.is(":visible")||(e.opened=!1,t("html").removeClass(i+"screenfull"),e._triggerHandler("pseudoFullscreenFallback")!==!1&&(e.opened=!0,e.usePseudeoFullscreenFallback=!0,t("html").addClass(i+"pseudo-fullscreen")))},this.settings.fullscreenVisibleCheckDuration)},close:function(){this.opened&&((screenfull.isFullscreen||t("html").hasClass(i+"screenfull"))&&screenfull.exit(),this._onFullscreenClose(),this._trigger("close"))},_onFullscreenClose:function(){this.opened=!1,t("html").removeClass(i+"screenfull").removeClass(i+"pseudo-fullscreen"),this.currentIndex=-1,this._getAllItems().apImageZoom("destroy"),this._getAllItems().each(function(e,n){t(this).data("loaded",!1)})},isOpen:function(){return this.opened},next:function(){this.currentIndex<this._getItemCount()-1&&this._show(this.currentIndex+1,this.opened)},previous:function(){this.currentIndex>0&&this._show(this.currentIndex-1,this.opened)},first:function(){this._show(0,this.opened)},last:function(){this._show(this._getItemCount()-1,this.opened)},add:function(t,e){this._trigger("add")},remove:function(t){this._trigger("remove")},download:function(){var t=this._getCurrentItem().find("img").attr("src");window.open(t),this._trigger("download")},option:function(e,n){if(!e)return t.extend({},this.settings);var s;if("string"==typeof e){if(1===arguments.length)return void 0!==this.settings[e]?this.settings[e]:null;s={},s[e]=n}else s=e;this._setOptions(s)},_setOptions:function(t){for(key in t){var e=t[key];this.settings[key]=e}},destroy:function(){this._trigger("destroy"),this.opened&&this.close(),this._unbind(),this._removeContainer(),this.$elements.each(function(){t(this).removeData(s)})},_log:function(e){this.$log||(this.$log=t("<div></div>").addClass(i+"log").appendTo(t("body"))),this.$log.append(t("<p></p>").html(e))}},t.fn.apImageFullscreen=function(e){if("string"==typeof e){var i,o,r=[],a=Array.prototype.slice.call(arguments,1);return this.each(function(){if(i=t(this).data(s)){if("function"==typeof(o=i[e])&&"_"!==e.charAt(0)){var n=o.apply(i,a);void 0!==n&&r.push(n)}}else r.push(void 0)}),r.length?1===r.length?r[0]:r:this}var i=new n(this,e);return i?this:!1},n.defaultSettings={autoReassign:!0,autoOpen:!1,imageZoom:{minZoom:"contain",maxZoom:1,loadingAnimation:"throbber",loadingAnimationFadeOutDuration:500,doubleTap:"zoomToggle"},lazyLoad:"visible",slideDuration:250,resetOnOpen:!0,resetOnScroll:!0,defaultTheme:"dark",buttons:{close:{visible:!0,position:"right, top",text:"Close",theme:void 0},next:{visible:!0,position:"right, bottom",text:"Next",theme:void 0},previous:{visible:!0,position:"right, bottom",text:"Previous",theme:void 0},download:{visible:!0,position:"left, bottom",text:"Download",theme:void 0}},shortcuts:{escape:"close",space:"zoomToggle",tab:"next",shiftTab:"previous",up:"zoomIn",right:"next",down:"zoomOut",left:"previous",pageDown:"next",pageUp:"previous",pos1:"first",end:"last",paging:!0,zeroHandling:"first"},enableScreenfull:!0,fullscreenVisibleCheckDuration:20,enableSwipe:!0},n.template='<div class="'+i+'container"><div class="'+i+'fullscreen-element"><div class="'+i+"wrapper "+i+'clearfix"><ul class="'+i+'images"></ul></div></div></div>'}(jQuery);